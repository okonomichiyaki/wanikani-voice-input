(()=>{function t(t){return t&&t.__esModule?t.default:t}const e={EntryPrompt:"span.page-header__icon.page-header__icon",EntryMeaning:"#section-meaning > section:nth-child(1) > div:nth-child(1) > p",EntryAltMeanings:"#section-meaning > section:nth-child(1) > div:nth-child(2) > p",EntryKanjiReading:".subject-readings__reading--primary .subject-readings__reading-items",EntryVocabReading:".reading-with-audio__reading",Category:"span.quiz-input__question-category",Type:"span.quiz-input__question-type",Prompt:"div.character-header__characters",LessonMeaning:"div.character-header__meaning",Synonyms:"#quiz-user-synonyms script",Subjects:'#quiz-queue > script[data-quiz-queue-target="subjects"]',Next:"div.quiz-input__input-container button"};function n(){const t=document.querySelector(e.Type);return t?t.textContent.trim().toLowerCase():document.location.href.match("vocabulary")||document.location.href.match("kanji")?"reading":document.location.href.match("radicals")?"name":null}function r(){const t=n();return"meaning"===t||"name"===t?"en-US":"reading"===t?"ja-JP":"en-US"}function o(){const t=document.querySelector(e.EntryPrompt);if(!t)return null;let n=t.textContent;return""===n?null:n}function i(){let t="";document.location.href.match("review")&&(t="review"),document.location.href.match("lesson")&&(t="lesson"),document.location.href.match("quiz")&&(t="quiz"),document.location.href.match("vocabulary|radicals|kanji")&&(t="entry");const r=function(){const t=document.querySelector(e.Prompt);if(!t)return o();let n=t.textContent;return""===n&&t.childNodes.length>0&&t.childNodes[0].getAttribute("aria-label")&&(n=t.childNodes[0].getAttribute("aria-label").toLowerCase()),""===n?null:n}(),i=function(){const t=document.querySelector(e.Subjects);if(!t)return function(){const t=o(),n=document.querySelector(e.EntryMeaning);let r=document.querySelector(e.EntryKanjiReading);r||(r=document.querySelector(e.EntryVocabReading));if(!t||!n||!r)return null;const i={},c={};c.meanings=[n.textContent],c.readings=[{reading:r.textContent.trim()}],i[n.textContent]=[c],i[c.readings[0]]=[c],i[t]=[c];const a=document.querySelector(e.EntryAltMeaning);if(a){const t=a.textContent.split(",").map((t=>t.trim()));for(const e of t)i[e]=[c];c.meanings.push(...t)}return i}();const n=JSON.parse(t.textContent),r={};for(const t of n){if(t.primary_reading_type){const e=t[t.primary_reading_type].map((function(t){return{reading:t}}));t.readings=e}"Radical"===t.type&&(t.readings=[]);const e=c(t.id);t.meanings.push(...e);const n=[t.id,t.characters];for(const e of t.meanings)n.push(e.toLowerCase());for(const e of n)r[e]||(r[e]=[]),r[e].push(t)}return r}(),a=r&&i?i[r]:[],s=function(){const t=document.querySelector(e.Category);return t?t.textContent.trim().toLowerCase():document.location.href.match("vocabulary")?"vocabulary":document.location.href.match("kanji")?"kanji":document.location.href.match("radicals")?"radical":null}(),u=n(),l=[],f=[];for(const t of a){t.readings&&l.push(...t.readings.map((t=>t.reading))),f.push(...t.meanings);const e=c(t.id);f.push(...e)}return{page:t,prompt:r,category:s,type:u,meanings:f,readings:l}}function c(t){const n=document.querySelector(e.Synonyms);if(n){const e=JSON.parse(n.textContent);if(e[t])return e[t]}return[]}function a(){const t=document.querySelector(e.Next);return!!t&&(t.click(),!0)}function s(){u("en-US"===r()?"aaa":"ã‚ã‚ã‚")}function u(t){return function(t){const e=document.querySelector("#user-response");e&&(e.value=t)}(t),a()}function l(){const t=document.getElementById("information");if(!t)return!0;return!new Array(t.classList).some((t=>t.toString().includes("open")))}function f(){const t=document.querySelectorAll("#additional-content a");for(let e of t)if(e.textContent.includes("Item Info"))return void(l()&&e.click())}function d(t){return null===t?"null":t!==Object(t)?typeof t:{}.toString.call(t).slice(8,-1).toLowerCase()}function p(t){return"string"!==d(t)||!t.length}function h(t="",e,n){if(p(t))return!1;const r=t.charCodeAt(0);return e<=r&&r<=n}const g={HIRAGANA:"toHiragana",KATAKANA:"toKatakana"},y="hepburn",m={useObsoleteKana:!1,passRomaji:!1,upcaseKatakana:!1,IMEMode:!1,convertLongVowelMark:!0,romanization:y},b=65,w=90,v=12353,j=12438,k=12449,O=12540,C=19968,S=40879,A=12540,_=12539,E=[65313,65338],x=[65345,65370],M=[65377,65381],q=[[12288,12351],M,[12539,12540],[65281,65295],[65306,65311],[65339,65343],[65371,65376],[65504,65518]],z=[...[[12352,12447],[12448,12543],M,[65382,65439]],...q,E,x,[65296,65305],[19968,40959],[13312,19903]],N=[[0,127],[256,257],[274,275],[298,299],[332,333],[362,363]],R=[[32,47],[58,63],[91,96],[123,126],[8216,8217],[8220,8221]];function L(t=""){return z.some((([e,n])=>h(t,e,n)))}function I(t="",e){const n="regexp"===d(e);return!p(t)&&[...t].every((t=>{const r=L(t);return n?r||e.test(t):r}))}var T=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function K(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(r=t[n],o=e[n],!(r===o||T(r)&&T(o)))return!1;var r,o;return!0}function J(t,e){void 0===e&&(e=K);var n=null;function r(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(n&&n.lastThis===this&&e(r,n.lastArgs))return n.lastResult;var i=t.apply(this,r);return n={lastResult:i,lastArgs:r,lastThis:this},i}return r.clear=function(){n=null},r}var $=Object.prototype.hasOwnProperty;function W(t,e,n){for(n of t.keys())if(D(n,e))return n}function D(t,e){var n,r,o;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&D(t[r],e[r]););return-1===r}if(n===Set){if(t.size!==e.size)return!1;for(r of t){if((o=r)&&"object"==typeof o&&!(o=W(e,o)))return!1;if(!e.has(o))return!1}return!0}if(n===Map){if(t.size!==e.size)return!1;for(r of t){if((o=r[0])&&"object"==typeof o&&!(o=W(e,o)))return!1;if(!D(r[1],e.get(o)))return!1}return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((r=t.byteLength)===e.byteLength)for(;r--&&t.getInt8(r)===e.getInt8(r););return-1===r}if(ArrayBuffer.isView(t)){if((r=t.byteLength)===e.byteLength)for(;r--&&t[r]===e[r];);return-1===r}if(!n||"object"==typeof t){for(n in r=0,t){if($.call(t,n)&&++r&&!$.call(e,n))return!1;if(!(n in e)||!D(t[n],e[n]))return!1}return Object.keys(e).length===r}}return t!=t&&e!=e}const V=(t={})=>Object.assign({},m,t);function F(t,e,n){const r=e;function o(t,e){const n=t.charAt(0);return i(Object.assign({"":n},r[n]),t.slice(1),e,e+1)}function i(t,e,r,c){if(!e)return n||1===Object.keys(t).length?t[""]?[[r,c,t[""]]]:[]:[[r,c,null]];if(1===Object.keys(t).length)return[[r,c,t[""]]].concat(o(e,c));const a=function(t,e){if(void 0!==t[e])return Object.assign({"":t[""]+e},t[e])}(t,e.charAt(0));return void 0===a?[[r,c,t[""]]].concat(o(e,c)):i(a,e.slice(1),r,c+1)}return o(t,0)}function B(t){return Object.entries(t).reduce(((t,[e,n])=>{const r="string"===d(n);return t[e]=r?{"":n}:B(n),t}),{})}function P(t,e){return e.split("").reduce(((t,e)=>(void 0===t[e]&&(t[e]={}),t[e])),t)}function U(t={}){const e={};return"object"===d(t)&&Object.entries(t).forEach((([t,n])=>{let r=e;t.split("").forEach((t=>{void 0===r[t]&&(r[t]={}),r=r[t]})),r[""]=n})),function(t){return function t(e,n){return void 0===e||"string"===d(e)?n:Object.entries(n).reduce(((n,[r,o])=>(n[r]=t(e[r],o),n)),e)}(JSON.parse(JSON.stringify(t)),e)}}function G(t,e){return e?"function"===d(e)?e(t):U(e)(t):t}const H={a:"ã‚",i:"ã„",u:"ã†",e:"ãˆ",o:"ãŠ",k:{a:"ã‹",i:"ã",u:"ã",e:"ã‘",o:"ã“"},s:{a:"ã•",i:"ã—",u:"ã™",e:"ã›",o:"ã"},t:{a:"ãŸ",i:"ã¡",u:"ã¤",e:"ã¦",o:"ã¨"},n:{a:"ãª",i:"ã«",u:"ã¬",e:"ã­",o:"ã®"},h:{a:"ã¯",i:"ã²",u:"ãµ",e:"ã¸",o:"ã»"},m:{a:"ã¾",i:"ã¿",u:"ã‚€",e:"ã‚",o:"ã‚‚"},y:{a:"ã‚„",u:"ã‚†",o:"ã‚ˆ"},r:{a:"ã‚‰",i:"ã‚Š",u:"ã‚‹",e:"ã‚Œ",o:"ã‚"},w:{a:"ã‚",i:"ã‚",e:"ã‚‘",o:"ã‚’"},g:{a:"ãŒ",i:"ã",u:"ã",e:"ã’",o:"ã”"},z:{a:"ã–",i:"ã˜",u:"ãš",e:"ãœ",o:"ã"},d:{a:"ã ",i:"ã¢",u:"ã¥",e:"ã§",o:"ã©"},b:{a:"ã°",i:"ã³",u:"ã¶",e:"ã¹",o:"ã¼"},p:{a:"ã±",i:"ã´",u:"ã·",e:"ãº",o:"ã½"},v:{a:"ã‚”ã",i:"ã‚”ãƒ",u:"ã‚”",e:"ã‚”ã‡",o:"ã‚”ã‰"}},Q={".":"ã€‚",",":"ã€",":":"ï¼š","/":"ãƒ»","!":"ï¼","?":"ï¼Ÿ","~":"ã€œ","-":"ãƒ¼","â€˜":"ã€Œ","â€™":"ã€","â€œ":"ã€","â€":"ã€","[":"ï¼»","]":"ï¼½","(":"ï¼ˆ",")":"ï¼‰","{":"ï½›","}":"ï½"},X={k:"ã",s:"ã—",t:"ã¡",n:"ã«",h:"ã²",m:"ã¿",r:"ã‚Š",g:"ã",z:"ã˜",d:"ã¢",b:"ã³",p:"ã´",v:"ã‚”",q:"ã",f:"ãµ"},Y={ya:"ã‚ƒ",yi:"ãƒ",yu:"ã‚…",ye:"ã‡",yo:"ã‚‡"},Z={a:"ã",i:"ãƒ",u:"ã…",e:"ã‡",o:"ã‰"},tt={sh:"sy",ch:"ty",cy:"ty",chy:"ty",shy:"sy",j:"zy",jy:"zy",shi:"si",chi:"ti",tsu:"tu",ji:"zi",fu:"hu"},et=Object.assign({tu:"ã£",wa:"ã‚",ka:"ãƒµ",ke:"ãƒ¶"},Z,Y),nt={yi:"ã„",wu:"ã†",ye:"ã„ã‡",wi:"ã†ãƒ",we:"ã†ã‡",kwa:"ãã",whu:"ã†",tha:"ã¦ã‚ƒ",thu:"ã¦ã‚…",tho:"ã¦ã‚‡",dha:"ã§ã‚ƒ",dhu:"ã§ã‚…",dho:"ã§ã‚‡"},rt={wh:"ã†",kw:"ã",qw:"ã",q:"ã",gw:"ã",sw:"ã™",ts:"ã¤",th:"ã¦",tw:"ã¨",dh:"ã§",dw:"ã©",fw:"ãµ",f:"ãµ"};function ot(){const t=B(H),e=e=>P(t,e);function n(t){return Object.entries(t).reduce(((t,[e,r])=>(t[e]=e?n(r):`ã£${r}`,t)),{})}return Object.entries(X).forEach((([t,n])=>{Object.entries(Y).forEach((([r,o])=>{e(t+r)[""]=n+o}))})),Object.entries(Q).forEach((([t,n])=>{e(t)[""]=n})),Object.entries(rt).forEach((([t,n])=>{Object.entries(Z).forEach((([r,o])=>{e(t+r)[""]=n+o}))})),["n","n'","xn"].forEach((t=>{e(t)[""]="ã‚“"})),t.c=JSON.parse(JSON.stringify(t.k)),Object.entries(tt).forEach((([t,n])=>{const r=t.slice(0,t.length-1),o=t.charAt(t.length-1);e(r)[o]=JSON.parse(JSON.stringify(e(n)))})),Object.entries(et).forEach((([t,n])=>{const r=t=>t.charAt(t.length-1),o=t=>t.slice(0,t.length-1),i=e(`x${t}`);i[""]=n;var c;e(`l${o(t)}`)[r(t)]=i,(c=t,[...Object.entries(tt),["c","k"]].reduce(((t,[e,n])=>c.startsWith(n)?t.concat(c.replace(n,e)):t),[])).forEach((n=>{["l","x"].forEach((i=>{e(i+o(n))[r(n)]=e(i+t)}))}))})),Object.entries(nt).forEach((([t,n])=>{e(t)[""]=n})),[...Object.keys(X),"c","y","w","j"].forEach((e=>{const r=t[e];r[e]=n(r)})),delete t.n.n,Object.freeze(JSON.parse(JSON.stringify(t)))}let it=null;const ct=U({wi:"ã‚",we:"ã‚‘"});function at(t=""){return!p(t)&&h(t,b,w)}function st(t=""){return!p(t)&&t.charCodeAt(0)===A}function ut(t=""){return!p(t)&&t.charCodeAt(0)===_}function lt(t=""){return!p(t)&&(!!st(t)||h(t,v,j))}function ft(t=""){const e=[];return t.split("").forEach((t=>{if(st(t)||ut(t))e.push(t);else if(lt(t)){const n=t.charCodeAt(0)+(k-v),r=String.fromCharCode(n);e.push(r)}else e.push(t)})),e.join("")}const dt=J(((t,e,n)=>{let r=(null==it&&(it=ot()),it);return r=t?function(t){const e=JSON.parse(JSON.stringify(t));return e.n.n={"":"ã‚“"},e.n[" "]={"":"ã‚“"},e}(r):r,r=e?ct(r):r,n&&(r=G(r,n)),r}),D);function pt(t="",e={},n){let r;return n?r=e:(r=V(e),n=dt(r.IMEMode,r.useObsoleteKana,r.customKanaMapping)),function(t="",e={},n){const{IMEMode:r,useObsoleteKana:o,customKanaMapping:i}=e;n||(n=dt(r,o,i));return F(t.toLowerCase(),n,!r)}(t,r,n).map((e=>{const[n,o,i]=e;if(null===i)return t.slice(n);const c=r.IMEMode===g.HIRAGANA,a=r.IMEMode===g.KATAKANA||[...t.slice(n,o)].every(at);return c||!a?i:ft(i)})).join("")}function ht(t=""){return!p(t)&&N.some((([e,n])=>h(t,e,n)))}function gt(t="",e){const n="regexp"===d(e);return!p(t)&&[...t].every((t=>{const r=ht(t);return n?r||e.test(t):r}))}function yt(t=""){return h(t,k,O)}function mt(t=""){return!p(t)&&[...t].every(lt)}function bt(t=""){return!p(t)&&[...t].every(yt)}function wt(t=""){return h(t,C,S)}function vt(t=""){return!p(t)&&[...t].every(wt)}function jt(t="",e={passKanji:!0}){const n=[...t];let r=!1;return e.passKanji||(r=n.some(vt)),(n.some(mt)||n.some(bt))&&n.some(gt)&&!r}const kt=(t,e)=>st(t)&&e<1,Ot=(t,e)=>st(t)&&e>0,Ct=t=>["ãƒ¶","ãƒµ"].includes(t),St={a:"ã‚",i:"ã„",u:"ã†",e:"ãˆ",o:"ã†"};function At(t="",e,{isDestinationRomaji:n,convertLongVowelMark:r}={}){let o="";return t.split("").reduce(((i,c,a)=>{if(ut(c)||kt(c,a)||Ct(c))return i.concat(c);if(r&&o&&Ot(c,a)){const r=e(o).slice(-1);return yt(t[a-1])&&"o"===r&&n?i.concat("ãŠ"):i.concat(St[r])}if(!st(c)&&yt(c)){const t=c.charCodeAt(0)+(v-k),e=String.fromCharCode(t);return o=e,i.concat(e)}return o="",i.concat(c)}),[]).join("")}let _t=null;const Et={"ã‚":"a","ã„":"i","ã†":"u","ãˆ":"e","ãŠ":"o","ã‹":"ka","ã":"ki","ã":"ku","ã‘":"ke","ã“":"ko","ã•":"sa","ã—":"shi","ã™":"su","ã›":"se","ã":"so","ãŸ":"ta","ã¡":"chi","ã¤":"tsu","ã¦":"te","ã¨":"to","ãª":"na","ã«":"ni","ã¬":"nu","ã­":"ne","ã®":"no","ã¯":"ha","ã²":"hi","ãµ":"fu","ã¸":"he","ã»":"ho","ã¾":"ma","ã¿":"mi","ã‚€":"mu","ã‚":"me","ã‚‚":"mo","ã‚‰":"ra","ã‚Š":"ri","ã‚‹":"ru","ã‚Œ":"re","ã‚":"ro","ã‚„":"ya","ã‚†":"yu","ã‚ˆ":"yo","ã‚":"wa","ã‚":"wi","ã‚‘":"we","ã‚’":"wo","ã‚“":"n","ãŒ":"ga","ã":"gi","ã":"gu","ã’":"ge","ã”":"go","ã–":"za","ã˜":"ji","ãš":"zu","ãœ":"ze","ã":"zo","ã ":"da","ã¢":"ji","ã¥":"zu","ã§":"de","ã©":"do","ã°":"ba","ã³":"bi","ã¶":"bu","ã¹":"be","ã¼":"bo","ã±":"pa","ã´":"pi","ã·":"pu","ãº":"pe","ã½":"po","ã‚”ã":"va","ã‚”ãƒ":"vi","ã‚”":"vu","ã‚”ã‡":"ve","ã‚”ã‰":"vo"},xt={"ã€‚":".","ã€":",","ï¼š":":","ãƒ»":"/","ï¼":"!","ï¼Ÿ":"?","ã€œ":"~","ãƒ¼":"-","ã€Œ":"â€˜","ã€":"â€™","ã€":"â€œ","ã€":"â€","ï¼»":"[","ï¼½":"]","ï¼ˆ":"(","ï¼‰":")","ï½›":"{","ï½":"}","ã€€":" "},Mt=["ã‚","ã„","ã†","ãˆ","ãŠ","ã‚„","ã‚†","ã‚ˆ"],qt={"ã‚ƒ":"ya","ã‚…":"yu","ã‚‡":"yo"},zt={"ãƒ":"yi","ã‡":"ye"},Nt={"ã":"a","ãƒ":"i","ã…":"u","ã‡":"e","ã‰":"o"},Rt=["ã","ã«","ã²","ã¿","ã‚Š","ã","ã³","ã´","ã‚”","ã","ãµ"],Lt={"ã—":"sh","ã¡":"ch","ã˜":"j","ã¢":"j"},It={"ã£":"","ã‚ƒ":"ya","ã‚…":"yu","ã‚‡":"yo","ã":"a","ãƒ":"i","ã…":"u","ã‡":"e","ã‰":"o"},Tt={b:"b",c:"t",d:"d",f:"f",g:"g",h:"h",j:"j",k:"k",m:"m",p:"p",q:"q",r:"r",s:"s",t:"t",v:"v",w:"w",x:"x",z:"z"};function Kt(){return null==_t&&(_t=function(){const t=B(Et),e=e=>P(t,e),n=(t,n)=>{e(t)[""]=n};return Object.entries(xt).forEach((([t,n])=>{e(t)[""]=n})),[...Object.entries(qt),...Object.entries(Nt)].forEach((([t,e])=>{n(t,e)})),Rt.forEach((t=>{const r=e(t)[""][0];Object.entries(qt).forEach((([e,o])=>{n(t+e,r+o)})),Object.entries(zt).forEach((([e,o])=>{n(t+e,r+o)}))})),Object.entries(Lt).forEach((([t,e])=>{Object.entries(qt).forEach((([r,o])=>{n(t+r,e+o[1])})),n(`${t}ãƒ`,`${e}yi`),n(`${t}ã‡`,`${e}e`)})),t["ã£"]=Jt(t),Object.entries(It).forEach((([t,e])=>{n(t,e)})),Mt.forEach((t=>{n(`ã‚“${t}`,`n'${e(t)[""]}`)})),Object.freeze(JSON.parse(JSON.stringify(t)))}()),_t}function Jt(t){return Object.entries(t).reduce(((t,[e,n])=>{if(e)t[e]=Jt(n);else{const r=n.charAt(0);t[e]=Object.keys(Tt).includes(r)?Tt[r]+n:n}return t}),{})}const $t=J(((t,e)=>{let n=function(t){return t===y?Kt():{}}(t);return e&&(n=G(n,e)),n}),D);function Wt(t="",e={},n){const r=V(e);return n||(n=$t(r.romanization,r.customRomajiMapping)),function(t,e,n){n||(n=$t(e.romanization,e.customRomajiMapping));const r=Object.assign({},{isDestinationRomaji:!0},e);return F(At(t,Wt,r),n,!e.IMEMode)}(t,r,n).map((e=>{const[n,o,i]=e;return r.upcaseKatakana&&bt(t.slice(n,o))?i.toUpperCase():i})).join("")}function Dt(t=""){return!p(t)&&R.some((([e,n])=>h(t,e,n)))}function Vt(t="",e={}){const n=V(e);if(n.passRomaji)return At(t,Wt,n);if(jt(t,{passKanji:!0})){return pt(At(t,Wt,n).toLowerCase(),n)}return gt(t)||Dt(t)?pt(t.toLowerCase(),n):At(t,Wt,n)}var Ft={};Ft=function(){function t(t,e,n,r,o){return t<e||n<e?t>n?n+1:t+1:r===o?e:e+1}return function(e,n){if(e===n)return 0;if(e.length>n.length){var r=e;e=n,n=r}for(var o=e.length,i=n.length;o>0&&e.charCodeAt(o-1)===n.charCodeAt(i-1);)o--,i--;for(var c=0;c<o&&e.charCodeAt(c)===n.charCodeAt(c);)c++;if(i-=c,0===(o-=c)||i<3)return i;var a,s,u,l,f,d,p,h,g,y,m,b,w=0,v=[];for(a=0;a<o;a++)v.push(a+1),v.push(e.charCodeAt(c+a));for(var j=v.length-1;w<i-3;)for(g=n.charCodeAt(c+(s=w)),y=n.charCodeAt(c+(u=w+1)),m=n.charCodeAt(c+(l=w+2)),b=n.charCodeAt(c+(f=w+3)),d=w+=4,a=0;a<j;a+=2)s=t(p=v[a],s,u,g,h=v[a+1]),u=t(s,u,l,y,h),l=t(u,l,f,m,h),d=t(l,f,d,b,h),v[a]=d,f=l,l=u,u=s,s=p;for(;w<i;)for(g=n.charCodeAt(c+(s=w)),d=++w,a=0;a<j;a+=2)p=v[a],v[a]=d=t(p,s,d,g,v[a+1]),s=p;return d}}();const Bt={b:"ã³",ezone:"ã„ãã‚“",gt:"ã˜ã",g:"ã˜",ec2:"ã„ã—ã¤","ec 2":"ã„ã—ã¤",ec:"ã„ã—",agar:"ã‚ãŒã‚‹",ol:"ãŠãˆã‚‹",ob:"ãŠã³",k:"ã‘ã„",c:"ã—",cd:"ã—ã‚Š",ck:"ã—ã‘ã„",y:"ã‚ã„",uber:"ã†ã°",hulu:"ãµã‚‹",canyou:"ã‹ã‚“ã‚†ã†",LINE:"ã‚‰ã„",2:"ã¤",3:"ã•ã‚“",5:"ã”",9:"ãã‚…ã†",10:"ã˜ã‚…",x:"ã˜ã‚…",1e3:"ã›ã‚“","ãƒ¯ãƒ¼ã":"ã‚ã","è¥¿å›½":"ã•ã„ã“ã","å¸°ã£ã¦":"ã‹ãˆã£ã¦","ã‚’å‘¼ã¶":"ãŠã‚ˆã¶","æŒè¹ ":"ã—ã‚‡ã†ã›ã","ä»¶å":"ã‘ã‚“ã‚ã„","åŠ è—¤":"ã‹ã¨ã†","è²¨ç‰©ç·š":"ã‹ã‚‚ã¤ã›ã‚“","çŸ­è¶³":"ãŸã‚“ãã","5å›":"ã”ã‹ã„","ã‘ãˆã":"ã‘ã„ã","è¦—ã„ã¦":"ã®ãã„ã¦","å»ƒç—…":"ã¯ã„ã³ã‚‡ã†","æ­£è¦³":"ã›ã„ã‹ã‚“","å€Ÿã‚Šã«":"ã‹ã‚Šã«","å…¨é–‹":"ãœã‚“ã‹ã„","ä¹å¤§":"ãã‚…ã†ã ã„","æœ€é€Ÿ":"ã•ã„ãã","é¾é¨":"ã‚Šã‚…ã†ã","æµæ˜Ÿ":"ã‚Šã‚…ã†ã›ã„","äº¬ä¸¹":"ãã‚‡ã†ãŸã‚“","åºƒé™µ":"ã“ã†ã‚Šã‚‡ã†","æ‹›ã‹ã‚Œã‚‹":"ã¾ã­ã‹ã‚Œã‚‹","çœŒå¢ƒ":"ã‘ã‚“ãã‚‡ã†","èƒ†æ±":"ãŸã‚“ã˜ã‚…ã†","çœŒå":"ã‘ã‚“ã‚ã„","é•·æ±Ÿ":"ã¡ã‚‡ã†ã“ã†","æ€§æ„Ÿ":"ã›ã„ã‹ã‚“"};function Pt(t,e){if(!I(t.data))return null;return Gt(t.data)===Gt(e)?e:null}function Ut(t,e){const n=t.data;for(const t of e)if(t===n||t===Bt[n.toLowerCase()])return t;return null}function Gt(t){return t.toLowerCase().replaceAll(" ","")}function Ht(e,n){const r=e.data;for(const e of n){if(Gt(e)===Gt(r))return e;if(t(Ft)(Gt(e),Gt(r))<2)return e}return null}function Qt(t,e){return{success:!0,message:"correct answer",candidate:t,answer:e}}function Xt(t,e,n){const{meanings:r,readings:o,prompt:i}=t;let c=[];c.push({type:"raw",data:n});const a=(s="order",e.reduce((function(t,e){return(t[e[s]]=t[e[s]]||[]).push(e),t}),{}));var s;const u=Object.keys(a).map((t=>parseInt(t))).sort();for(const t of u){const e=a[t],n=[];for(const t of e)for(const e of c)n.push(...t.getCandidates(e.data));c.push(...n)}let l={error:!1,message:"incorrect answer"};for(const t of c){const e=Ht(t,r),n=Ut(t,o),c=Pt(t,i);n?l=Qt(t,n):c&&o.length>0?l=Qt(t,o[0]):e&&(l=Qt(t,e))}return l.candidates=c,l.meanings=r,l.readings=o,l}const Yt="#ffd700",Zt="#000000";function te(){return ee().lightning}function ee(){return unsafeWindow.wkof?unsafeWindow.wkof.settings["wanikani-voice-input"]:{lightning:!1,transcript:!0,transcript_background:Yt,transcript_foreground:Zt,transcript_position:"top",transcript_delay:5e3}}function ne(t,e){if(!("webkitSpeechRecognition"in window))return console.error("[wanikani-voice-input] web speech not supported by this browser!"),null;const n=new webkitSpeechRecognition;return n.continuous=!0,n.interimResults=!0,n.lang=t,n.onresult=t=>{for(let n=t.resultIndex;n<t.results.length;++n){const r=t.results[n][0].transcript.trim(),o=t.results[n].isFinal;e(r,o)}},n.onerror=t=>{"no-speech"!==t.error&&console.error("[wanikani-voice-input] error occurred in recognition:",t.error)},n.onend=()=>{n.start()},n}function re(t,e){t.lang!=e&&(t.stop(),t.lang=e)}function oe(t){let e=t.transcript_position,n="width: 100%; position: absolute; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: none;";return"top"===e||"bottom"===e?n+=` ${e}: 0px`:"center"===e&&(n+=" top: 45vh"),n}function ie(t){const e=document.createElement("div");e.id="wanikani-voice-input-transcript-container",e.style=oe(t),document.body.appendChild(e)}let ce=1;function ae(t){const e=document.getElementById(t);if(e){e.parentElement.removeChild(e)}}function se(t,e){if(!t.transcript)return;const n="ğŸ¤"+e,r=document.getElementById("transcript-"+(ce-1));if(r&&n===r.textContent)return;const o=ce++,i=`transcript-${o}`,c=document.createElement("p");c.id=i,c.style=function(t){return`color: ${t.transcript_foreground}; background-color: ${t.transcript_background}; font-size: 5vh; pointer-events: auto;`}(t),c.textContent=n;const a=document.querySelector("div#wanikani-voice-input-transcript-container");a.style=oe(t),a.appendChild(c),setTimeout(function(t){return function(){ae(t)}}(i),1e3*t.transcript_delay);const s=o-10;for(let e=o-t.transcript_count;e>=s&&e>=0;e--)ae(`transcript-${e}`)}function ue(t,e,n){t[e]||(t[e]=n),t[e].push(n)}function le(){let t=JSON.parse(GM_getResourceText("jmdict")),e=JSON.parse(GM_getResourceText("kanjidic2")),n={};for(const[e,r]of Object.entries(t))ue(n,e,r);for(const[t,r]of Object.entries(e))ue(n,t,r);const r=Object.keys(n).length;return console.log(`[wanikani-voice-input] got dictionary with ${r} entries`),n}class fe{constructor(t){this.order=0}getCandidates(t){const e=[];if(I(t)){const n=Vt(t,{convertLongVowelMark:!0});e.push({type:"hiragana",data:n})}return e}}class de{constructor(t){this.order=0,this.dictionary=t}getCandidates(t){if(!I(t))return[];const e=[],n=Vt(t);const r=function(t){return t.flatMap((t=>"word"===t.type?t.kana.map(Vt):"character"===t.type?t.readings.map((t=>{let e=t.value;return e.includes(".")&&(e=e.split(".")[0]),Vt(e)})):[]))}(this.dictionary[n]||[]);for(let t of r)e.push({type:"dictionary",data:t});return e}}class pe{constructor(t){this.order=0,this.basicDictionary=new de(t)}getCandidates(t){const e=Vt(t),n=[];if(e.endsWith("ã™ã‚‹")){const t=e.substring(0,e.length-2),r=this.basicDictionary.getCandidates(t);for(let t of r)n.push({type:"ã™ã‚‹",data:t+"ã™ã‚‹"})}return n}}class he{constructor(){this.order=1}getCandidates(t){const e=[],n=function(t){let e=t.length;for(let n=Math.floor(e/2);n>0;n--)if(e%n==0){let r=!0,o=t.slice(0,n);for(let i=n;i<e;i+=n)if(t.slice(i,i+n)!==o){r=!1;break}if(r)return o}return null}(t);return n&&e.push({type:"repeating",data:n}),e}}!function(){const t=["ã‚","ã„","ã†","ãˆ","ã„","ãŠ","ã†","ã‹","ã","ã","ã‘","ã‘","ã“","ã“","ãŒ","ã","ã","ã’","ã’","ã”","ã”","ã•","ã—","ã™","ã›","ã›","ã","ã","ã–","ã˜","ãš","ãœ","ãœ","ã","ã","ãŸ","ã¡","ã¤","ã¦","ã¦","ã¨","ã¨","ã ","ã¢","ã¥","ã§","ã§","ã©","ã©","ãª","ã«","ã¬","ã­","ã­","ã®","ã®","ã¯","ã²","ãµ","ã¸","ã¸","ã»","ã»","ã°","ã³","ã¶","ã¹","ã¹","ã¼","ã¼","ã±","ã´","ã·","ãº","ãº","ã½","ã½","ã¾","ã¿","ã‚€","ã‚","ã‚","ã‚‚","ã‚‚","ã‚„","yi","ã‚†","ye","ye","ã‚ˆ","ã‚ˆ","ã‚‰","ã‚Š","ã‚‹","ã‚Œ","ã‚Œ","ã‚","ã‚","ã‚","ã‚","wu","ã‚‘","ã‚‘","ã‚’","ã‚’"],e=[];for(let n=0;n<t.length;n+=7){const r=t.slice(n,n+7);e.push(r)}const n={};for(let t=0;t<e.length;t++){const r=e[t];for(let t=0;t<7;t++)(n[r[t]]=n[r[t]]||[]).push(e[0][t])}n["ã‚ƒ"]=["ã‚"],n["ã‚…"]=["ã†"],n["ã‚‡"]=["ãŠ","ã†"]}();class ge{constructor(t){this.order=0,this.dictionary=t}getCandidates(t){if(!t||0===t.length)return[];if(!I(t.split("").filter((t=>" "!==t)).join("")))return[];const e=[];if(t.includes(" ")){const n=t.split(" ").filter((t=>t.length>0)).map((t=>{const e=Vt(t);const n=function(t){return t.flatMap((t=>"word"===t.type?t.kana.map(Vt):"character"===t.type?t.readings.map((t=>{let e=t.value;return e.includes(".")&&(e=e.split(".")[0]),Vt(e)})):[]))}(this.dictionary[e]||[]);return n.length>0?n[0]:""}));e.push({type:"multiple",data:n.join("")})}return e}}const ye="ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™".split(""),me="0ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹";class be{constructor(t){this.order=0,this.basicDictionary=new de(t)}getCandidates(t){if(!t.match(/\d+/))return[];let e=t;for(let t=0;t<ye.length;t++)e=e.replaceAll(t.toString(),ye[t]);const n=this.basicDictionary.getCandidates(e);let r=t;for(let t=0;t<me.length;t++)r=r.replaceAll(t.toString(),me[t]);n.push({data:r});for(const t of n)t.type="numeral";return n}}function we(){const t=i();"review"!==t.page&&"lesson"!==t.page&&"quiz"!==t.page||function(){ie(ee());const t=le();let e="Flipping",n=i();function o(t){e=t}function c(){a(),o("Flipping")}const l={wrong:s,incorrect:s,mistake:s,"ä¸æ­£è§£":s,"ãµã›ã„ã‹ã„":s,"é–“é•ã„":s,"ã¾ã¡ãŒã„":s,"ã ã‚":s,"ãƒ€ãƒ¡":s,"é§„ç›®":s,next:c,"ã¤ã":c,"æ¬¡":c,NEXT:c,"ã­ãã™ã¨":c,"ãƒã‚¯ã‚¹ãƒˆ":c},d=[new fe,new de(t),new pe(t),new he,new ge(t),new be(t)],p=ne(r(),(function(t,n){se(ee(),t);let r=function(t,e,n,r,o){let c=e,a=null,s=null,u=!1,l=r;if("Ready"===e){const e=Xt(i(),t,r);console.log("[wanikani-voice-input]",r,e),e.candidate&&l!==e.candidate.data&&(l+=` (${e.candidate.data})`),e.success?o?(c="Flipping",a=e.answer):(c="Waiting",a=e.answer):e.error&&(l="!! "+e.message+" !!")}"Waiting"===e&&o&&(c="Flipping",u=te());("Ready"===e||"Flipping"===e)&&o&&n[r]&&(s=n[r]);return{newState:c,transcript:l,answer:a,command:s,lightning:u}}(d,e,l,t,n);se(ee(),r.transcript),e!==r.newState&&o(r.newState),r.answer&&u(r.answer),r.lightning&&setTimeout(a,100),r.command&&r.command()}));function h(t,c){const a=r();re(p,a);const s=function(t){const e=i();return t.prompt!==e.prompt||t.category!==e.category||t.type!==e.type?e:null}(n);"Flipping"===e&&s&&(o("Ready"),n=s)}const g={attributes:!0,childList:!0,subtree:!0};new MutationObserver(h).observe(document.body,g),window.addEventListener("didAnswerQuestion",(function(t){!function(t){if("object"!=typeof t.detail||"object"!=typeof t.detail.results)return console.error("[wanikani-voice-input] didAnswerCorrectly got unexpected event, WaniKani code change?",t),!1;const e=t.detail.results;return t.detail,"string"!=typeof e.action?(console.error("[wanikani-voice-input] didAnswerCorrectly got unexpected event, WaniKani code change?",t),!1):"pass"===e.action}(t)?te()&&setTimeout(f,100):"Ready"===e&&(e="Flipping",te()&&setTimeout(a,100))})),p.start(),e="Ready"}(),t.page}if(unsafeWindow.wkof){!function(t,e){function n(){var e={script_id:"wanikani-voice-input",title:"Voice Input",content:{lightning:{type:"checkbox",label:"Lightning mode",default:!1,hover_tip:"If enabled, automatically advance to the next flashcard on correct answers. If enabled, please disable lightning mode from any other scripts."},transcript:{type:"checkbox",label:"Live transcript",default:!0,hover_tip:"If enabled, displays a live transcript of dictation"},transcript_background:{type:"color",label:"Transcript background color",hover_tip:"Background color for the live transcript",default:Yt},transcript_foreground:{type:"color",label:"Transcript text color",hover_tip:"Text color for the live transcript",default:Zt},transcript_position:{type:"dropdown",label:"Transcript position",hover_tip:"Position on the page for the live transcript",default:"top",content:{top:"Top",bottom:"Bottom"}},transcript_delay:{type:"number",label:"Transcript delay",hover_tip:"Duration in seconds before live transcripts disappear",min:0,default:5},transcript_count:{type:"number",label:"Transcript count",hover_tip:"How many live transcripts to show (recommend setting position to bottom if this is more then 1)",min:1,default:1}}};new t.Settings(e).open()}t.include("Menu,Settings"),t.ready("Menu,Settings").then((function(){t.Menu.insert_script_link({name:"wanikani-voice-input",submenu:"Settings",title:"Voice Input",on_click:n})})).then((function(){return t.Settings.load("wanikani-voice-input")})).then(e)}(unsafeWindow.wkof,we)}else we()})();
//# sourceMappingURL=app.js.map
