(()=>{function t(t){return t&&t.__esModule?t.default:t}const n={Category:"span.quiz-input__question-category",Type:"span.quiz-input__question-type",Prompt:"div.character-header__characters",LessonMeaning:"div.character-header__meaning",Synonyms:"#quiz-user-synonyms script",Subjects:'#quiz-queue > script[data-quiz-queue-target="subjects"]',Next:"div.quiz-input__input-container button"};function e(){const t=document.querySelector(n.Type);return t?t.textContent.trim().toLowerCase():null}function r(){const t=e();return"meaning"===t||"name"===t?"en-US":"reading"===t?"ja-JP":"en-US"}function o(){const t=function(){const t=document.querySelector(n.Prompt);if(!t)return null;let e=t.textContent;return""===e&&t.childNodes.length>0&&t.childNodes[0].getAttribute("aria-label")&&(e=t.childNodes[0].getAttribute("aria-label").toLowerCase()),""===e?null:e}(),r=function(){const t=document.querySelector(n.Subjects);if(!t)return null;const e=JSON.parse(t.textContent),r={};for(const t of e){if(t.primary_reading_type){const n=t[t.primary_reading_type].map((function(t){return{reading:t}}));t.readings=n}"Radical"===t.type&&(t.readings=[]);const n=i(t.id);t.meanings.push(...n);const e=[t.id,t.characters];for(const n of t.meanings)e.push(n.toLowerCase());for(const n of e)r[n]||(r[n]=[]),r[n].push(t)}return r}(),o=t&&r?r[t]:[],c=function(){const t=document.querySelector(n.Category);return t?t.textContent.trim().toLowerCase():null}(),a=e(),s=[],u=[];for(const t of o){t.readings&&s.push(...t.readings.map((t=>t.reading))),u.push(...t.meanings);const n=i(t.id);u.push(...n)}return{prompt:t,category:c,type:a,meanings:u,readings:s}}function i(t){const e=document.querySelector(n.Synonyms);if(e){const n=JSON.parse(e.textContent);if(n[t])return n[t]}return[]}function c(){const t=document.querySelector(n.Next);return!!t&&(t.click(),!0)}function a(){s("en-US"===r()?"aaa":"„ÅÇ„ÅÇ„ÅÇ")}function s(t){return function(t){const n=document.querySelector("#user-response");n&&(n.value=t)}(t),c()}function u(){const t=document.getElementById("information");if(!t)return!0;return!new Array(t.classList).some((t=>t.toString().includes("open")))}function f(){const t=document.querySelectorAll("#additional-content a");for(let n of t)if(n.textContent.includes("Item Info"))return void(u()&&n.click())}function l(t){return null===t?"null":t!==Object(t)?typeof t:{}.toString.call(t).slice(8,-1).toLowerCase()}function p(t){return"string"!==l(t)||!t.length}function d(t="",n,e){if(p(t))return!1;const r=t.charCodeAt(0);return n<=r&&r<=e}const h={HIRAGANA:"toHiragana",KATAKANA:"toKatakana"},g="hepburn",y={useObsoleteKana:!1,passRomaji:!1,upcaseKatakana:!1,IMEMode:!1,convertLongVowelMark:!0,romanization:g},m=65,b=90,w=12353,v=12438,j=12449,k=12540,O=19968,C=40879,S=12540,A=12539,_=[65313,65338],E=[65345,65370],x=[65377,65381],M=[[12288,12351],x,[12539,12540],[65281,65295],[65306,65311],[65339,65343],[65371,65376],[65504,65518]],N=[...[[12352,12447],[12448,12543],x,[65382,65439]],...M,_,E,[65296,65305],[19968,40959],[13312,19903]],z=[[0,127],[256,257],[274,275],[298,299],[332,333],[362,363]],q=[[32,47],[58,63],[91,96],[123,126],[8216,8217],[8220,8221]];function L(t=""){return N.some((([n,e])=>d(t,n,e)))}function I(t="",n){const e="regexp"===l(n);return!p(t)&&[...t].every((t=>{const r=L(t);return e?r||n.test(t):r}))}var R=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function T(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(r=t[e],o=n[e],!(r===o||R(r)&&R(o)))return!1;var r,o;return!0}function $(t,n){void 0===n&&(n=T);var e=null;function r(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(e&&e.lastThis===this&&n(r,e.lastArgs))return e.lastResult;var i=t.apply(this,r);return e={lastResult:i,lastArgs:r,lastThis:this},i}return r.clear=function(){e=null},r}var J=Object.prototype.hasOwnProperty;function K(t,n,e){for(e of t.keys())if(W(e,n))return e}function W(t,n){var e,r,o;if(t===n)return!0;if(t&&n&&(e=t.constructor)===n.constructor){if(e===Date)return t.getTime()===n.getTime();if(e===RegExp)return t.toString()===n.toString();if(e===Array){if((r=t.length)===n.length)for(;r--&&W(t[r],n[r]););return-1===r}if(e===Set){if(t.size!==n.size)return!1;for(r of t){if((o=r)&&"object"==typeof o&&!(o=K(n,o)))return!1;if(!n.has(o))return!1}return!0}if(e===Map){if(t.size!==n.size)return!1;for(r of t){if((o=r[0])&&"object"==typeof o&&!(o=K(n,o)))return!1;if(!W(r[1],n.get(o)))return!1}return!0}if(e===ArrayBuffer)t=new Uint8Array(t),n=new Uint8Array(n);else if(e===DataView){if((r=t.byteLength)===n.byteLength)for(;r--&&t.getInt8(r)===n.getInt8(r););return-1===r}if(ArrayBuffer.isView(t)){if((r=t.byteLength)===n.byteLength)for(;r--&&t[r]===n[r];);return-1===r}if(!e||"object"==typeof t){for(e in r=0,t){if(J.call(t,e)&&++r&&!J.call(n,e))return!1;if(!(e in n)||!W(t[e],n[e]))return!1}return Object.keys(n).length===r}}return t!=t&&n!=n}const F=(t={})=>Object.assign({},y,t);function B(t,n,e){const r=n;function o(t,n){const e=t.charAt(0);return i(Object.assign({"":e},r[e]),t.slice(1),n,n+1)}function i(t,n,r,c){if(!n)return e||1===Object.keys(t).length?t[""]?[[r,c,t[""]]]:[]:[[r,c,null]];if(1===Object.keys(t).length)return[[r,c,t[""]]].concat(o(n,c));const a=function(t,n){if(void 0!==t[n])return Object.assign({"":t[""]+n},t[n])}(t,n.charAt(0));return void 0===a?[[r,c,t[""]]].concat(o(n,c)):i(a,n.slice(1),r,c+1)}return o(t,0)}function D(t){return Object.entries(t).reduce(((t,[n,e])=>{const r="string"===l(e);return t[n]=r?{"":e}:D(e),t}),{})}function V(t,n){return n.split("").reduce(((t,n)=>(void 0===t[n]&&(t[n]={}),t[n])),t)}function U(t={}){const n={};return"object"===l(t)&&Object.entries(t).forEach((([t,e])=>{let r=n;t.split("").forEach((t=>{void 0===r[t]&&(r[t]={}),r=r[t]})),r[""]=e})),function(t){return function t(n,e){return void 0===n||"string"===l(n)?e:Object.entries(e).reduce(((e,[r,o])=>(e[r]=t(n[r],o),e)),n)}(JSON.parse(JSON.stringify(t)),n)}}function P(t,n){return n?"function"===l(n)?n(t):U(n)(t):t}const G={a:"„ÅÇ",i:"„ÅÑ",u:"„ÅÜ",e:"„Åà",o:"„Åä",k:{a:"„Åã",i:"„Åç",u:"„Åè",e:"„Åë",o:"„Åì"},s:{a:"„Åï",i:"„Åó",u:"„Åô",e:"„Åõ",o:"„Åù"},t:{a:"„Åü",i:"„Å°",u:"„Å§",e:"„Å¶",o:"„Å®"},n:{a:"„Å™",i:"„Å´",u:"„Å¨",e:"„Å≠",o:"„ÅÆ"},h:{a:"„ÅØ",i:"„Å≤",u:"„Åµ",e:"„Å∏",o:"„Åª"},m:{a:"„Åæ",i:"„Åø",u:"„ÇÄ",e:"„ÇÅ",o:"„ÇÇ"},y:{a:"„ÇÑ",u:"„ÇÜ",o:"„Çà"},r:{a:"„Çâ",i:"„Çä",u:"„Çã",e:"„Çå",o:"„Çç"},w:{a:"„Çè",i:"„Çê",e:"„Çë",o:"„Çí"},g:{a:"„Åå",i:"„Åé",u:"„Åê",e:"„Åí",o:"„Åî"},z:{a:"„Åñ",i:"„Åò",u:"„Åö",e:"„Åú",o:"„Åû"},d:{a:"„Å†",i:"„Å¢",u:"„Å•",e:"„Åß",o:"„Å©"},b:{a:"„Å∞",i:"„Å≥",u:"„Å∂",e:"„Åπ",o:"„Åº"},p:{a:"„Å±",i:"„Å¥",u:"„Å∑",e:"„Å∫",o:"„ÅΩ"},v:{a:"„Çî„ÅÅ",i:"„Çî„ÅÉ",u:"„Çî",e:"„Çî„Åá",o:"„Çî„Åâ"}},H={".":"„ÄÇ",",":"„ÄÅ",":":"Ôºö","/":"„Éª","!":"ÔºÅ","?":"Ôºü","~":"„Äú","-":"„Éº","‚Äò":"„Äå","‚Äô":"„Äç","‚Äú":"„Äé","‚Äù":"„Äè","[":"Ôºª","]":"ÔºΩ","(":"Ôºà",")":"Ôºâ","{":"ÔΩõ","}":"ÔΩù"},Q={k:"„Åç",s:"„Åó",t:"„Å°",n:"„Å´",h:"„Å≤",m:"„Åø",r:"„Çä",g:"„Åé",z:"„Åò",d:"„Å¢",b:"„Å≥",p:"„Å¥",v:"„Çî",q:"„Åè",f:"„Åµ"},X={ya:"„ÇÉ",yi:"„ÅÉ",yu:"„ÇÖ",ye:"„Åá",yo:"„Çá"},Y={a:"„ÅÅ",i:"„ÅÉ",u:"„ÅÖ",e:"„Åá",o:"„Åâ"},Z={sh:"sy",ch:"ty",cy:"ty",chy:"ty",shy:"sy",j:"zy",jy:"zy",shi:"si",chi:"ti",tsu:"tu",ji:"zi",fu:"hu"},tt=Object.assign({tu:"„Å£",wa:"„Çé",ka:"„Éµ",ke:"„É∂"},Y,X),nt={yi:"„ÅÑ",wu:"„ÅÜ",ye:"„ÅÑ„Åá",wi:"„ÅÜ„ÅÉ",we:"„ÅÜ„Åá",kwa:"„Åè„ÅÅ",whu:"„ÅÜ",tha:"„Å¶„ÇÉ",thu:"„Å¶„ÇÖ",tho:"„Å¶„Çá",dha:"„Åß„ÇÉ",dhu:"„Åß„ÇÖ",dho:"„Åß„Çá"},et={wh:"„ÅÜ",kw:"„Åè",qw:"„Åè",q:"„Åè",gw:"„Åê",sw:"„Åô",ts:"„Å§",th:"„Å¶",tw:"„Å®",dh:"„Åß",dw:"„Å©",fw:"„Åµ",f:"„Åµ"};function rt(){const t=D(G),n=n=>V(t,n);function e(t){return Object.entries(t).reduce(((t,[n,r])=>(t[n]=n?e(r):`„Å£${r}`,t)),{})}return Object.entries(Q).forEach((([t,e])=>{Object.entries(X).forEach((([r,o])=>{n(t+r)[""]=e+o}))})),Object.entries(H).forEach((([t,e])=>{n(t)[""]=e})),Object.entries(et).forEach((([t,e])=>{Object.entries(Y).forEach((([r,o])=>{n(t+r)[""]=e+o}))})),["n","n'","xn"].forEach((t=>{n(t)[""]="„Çì"})),t.c=JSON.parse(JSON.stringify(t.k)),Object.entries(Z).forEach((([t,e])=>{const r=t.slice(0,t.length-1),o=t.charAt(t.length-1);n(r)[o]=JSON.parse(JSON.stringify(n(e)))})),Object.entries(tt).forEach((([t,e])=>{const r=t=>t.charAt(t.length-1),o=t=>t.slice(0,t.length-1),i=n(`x${t}`);i[""]=e;var c;n(`l${o(t)}`)[r(t)]=i,(c=t,[...Object.entries(Z),["c","k"]].reduce(((t,[n,e])=>c.startsWith(e)?t.concat(c.replace(e,n)):t),[])).forEach((e=>{["l","x"].forEach((i=>{n(i+o(e))[r(e)]=n(i+t)}))}))})),Object.entries(nt).forEach((([t,e])=>{n(t)[""]=e})),[...Object.keys(Q),"c","y","w","j"].forEach((n=>{const r=t[n];r[n]=e(r)})),delete t.n.n,Object.freeze(JSON.parse(JSON.stringify(t)))}let ot=null;const it=U({wi:"„Çê",we:"„Çë"});function ct(t=""){return!p(t)&&d(t,m,b)}function at(t=""){return!p(t)&&t.charCodeAt(0)===S}function st(t=""){return!p(t)&&t.charCodeAt(0)===A}function ut(t=""){return!p(t)&&(!!at(t)||d(t,w,v))}function ft(t=""){const n=[];return t.split("").forEach((t=>{if(at(t)||st(t))n.push(t);else if(ut(t)){const e=t.charCodeAt(0)+(j-w),r=String.fromCharCode(e);n.push(r)}else n.push(t)})),n.join("")}const lt=$(((t,n,e)=>{let r=(null==ot&&(ot=rt()),ot);return r=t?function(t){const n=JSON.parse(JSON.stringify(t));return n.n.n={"":"„Çì"},n.n[" "]={"":"„Çì"},n}(r):r,r=n?it(r):r,e&&(r=P(r,e)),r}),W);function pt(t="",n={},e){let r;return e?r=n:(r=F(n),e=lt(r.IMEMode,r.useObsoleteKana,r.customKanaMapping)),function(t="",n={},e){const{IMEMode:r,useObsoleteKana:o,customKanaMapping:i}=n;e||(e=lt(r,o,i));return B(t.toLowerCase(),e,!r)}(t,r,e).map((n=>{const[e,o,i]=n;if(null===i)return t.slice(e);const c=r.IMEMode===h.HIRAGANA,a=r.IMEMode===h.KATAKANA||[...t.slice(e,o)].every(ct);return c||!a?i:ft(i)})).join("")}function dt(t=""){return!p(t)&&z.some((([n,e])=>d(t,n,e)))}function ht(t="",n){const e="regexp"===l(n);return!p(t)&&[...t].every((t=>{const r=dt(t);return e?r||n.test(t):r}))}function gt(t=""){return d(t,j,k)}function yt(t=""){return!p(t)&&[...t].every(ut)}function mt(t=""){return!p(t)&&[...t].every(gt)}function bt(t=""){return d(t,O,C)}function wt(t=""){return!p(t)&&[...t].every(bt)}function vt(t="",n={passKanji:!0}){const e=[...t];let r=!1;return n.passKanji||(r=e.some(wt)),(e.some(yt)||e.some(mt))&&e.some(ht)&&!r}const jt=(t,n)=>at(t)&&n<1,kt=(t,n)=>at(t)&&n>0,Ot=t=>["„É∂","„Éµ"].includes(t),Ct={a:"„ÅÇ",i:"„ÅÑ",u:"„ÅÜ",e:"„Åà",o:"„ÅÜ"};function St(t="",n,{isDestinationRomaji:e,convertLongVowelMark:r}={}){let o="";return t.split("").reduce(((i,c,a)=>{if(st(c)||jt(c,a)||Ot(c))return i.concat(c);if(r&&o&&kt(c,a)){const r=n(o).slice(-1);return gt(t[a-1])&&"o"===r&&e?i.concat("„Åä"):i.concat(Ct[r])}if(!at(c)&&gt(c)){const t=c.charCodeAt(0)+(w-j),n=String.fromCharCode(t);return o=n,i.concat(n)}return o="",i.concat(c)}),[]).join("")}let At=null;const _t={"„ÅÇ":"a","„ÅÑ":"i","„ÅÜ":"u","„Åà":"e","„Åä":"o","„Åã":"ka","„Åç":"ki","„Åè":"ku","„Åë":"ke","„Åì":"ko","„Åï":"sa","„Åó":"shi","„Åô":"su","„Åõ":"se","„Åù":"so","„Åü":"ta","„Å°":"chi","„Å§":"tsu","„Å¶":"te","„Å®":"to","„Å™":"na","„Å´":"ni","„Å¨":"nu","„Å≠":"ne","„ÅÆ":"no","„ÅØ":"ha","„Å≤":"hi","„Åµ":"fu","„Å∏":"he","„Åª":"ho","„Åæ":"ma","„Åø":"mi","„ÇÄ":"mu","„ÇÅ":"me","„ÇÇ":"mo","„Çâ":"ra","„Çä":"ri","„Çã":"ru","„Çå":"re","„Çç":"ro","„ÇÑ":"ya","„ÇÜ":"yu","„Çà":"yo","„Çè":"wa","„Çê":"wi","„Çë":"we","„Çí":"wo","„Çì":"n","„Åå":"ga","„Åé":"gi","„Åê":"gu","„Åí":"ge","„Åî":"go","„Åñ":"za","„Åò":"ji","„Åö":"zu","„Åú":"ze","„Åû":"zo","„Å†":"da","„Å¢":"ji","„Å•":"zu","„Åß":"de","„Å©":"do","„Å∞":"ba","„Å≥":"bi","„Å∂":"bu","„Åπ":"be","„Åº":"bo","„Å±":"pa","„Å¥":"pi","„Å∑":"pu","„Å∫":"pe","„ÅΩ":"po","„Çî„ÅÅ":"va","„Çî„ÅÉ":"vi","„Çî":"vu","„Çî„Åá":"ve","„Çî„Åâ":"vo"},Et={"„ÄÇ":".","„ÄÅ":",","Ôºö":":","„Éª":"/","ÔºÅ":"!","Ôºü":"?","„Äú":"~","„Éº":"-","„Äå":"‚Äò","„Äç":"‚Äô","„Äé":"‚Äú","„Äè":"‚Äù","Ôºª":"[","ÔºΩ":"]","Ôºà":"(","Ôºâ":")","ÔΩõ":"{","ÔΩù":"}","„ÄÄ":" "},xt=["„ÅÇ","„ÅÑ","„ÅÜ","„Åà","„Åä","„ÇÑ","„ÇÜ","„Çà"],Mt={"„ÇÉ":"ya","„ÇÖ":"yu","„Çá":"yo"},Nt={"„ÅÉ":"yi","„Åá":"ye"},zt={"„ÅÅ":"a","„ÅÉ":"i","„ÅÖ":"u","„Åá":"e","„Åâ":"o"},qt=["„Åç","„Å´","„Å≤","„Åø","„Çä","„Åé","„Å≥","„Å¥","„Çî","„Åè","„Åµ"],Lt={"„Åó":"sh","„Å°":"ch","„Åò":"j","„Å¢":"j"},It={"„Å£":"","„ÇÉ":"ya","„ÇÖ":"yu","„Çá":"yo","„ÅÅ":"a","„ÅÉ":"i","„ÅÖ":"u","„Åá":"e","„Åâ":"o"},Rt={b:"b",c:"t",d:"d",f:"f",g:"g",h:"h",j:"j",k:"k",m:"m",p:"p",q:"q",r:"r",s:"s",t:"t",v:"v",w:"w",x:"x",z:"z"};function Tt(){return null==At&&(At=function(){const t=D(_t),n=n=>V(t,n),e=(t,e)=>{n(t)[""]=e};return Object.entries(Et).forEach((([t,e])=>{n(t)[""]=e})),[...Object.entries(Mt),...Object.entries(zt)].forEach((([t,n])=>{e(t,n)})),qt.forEach((t=>{const r=n(t)[""][0];Object.entries(Mt).forEach((([n,o])=>{e(t+n,r+o)})),Object.entries(Nt).forEach((([n,o])=>{e(t+n,r+o)}))})),Object.entries(Lt).forEach((([t,n])=>{Object.entries(Mt).forEach((([r,o])=>{e(t+r,n+o[1])})),e(`${t}„ÅÉ`,`${n}yi`),e(`${t}„Åá`,`${n}e`)})),t["„Å£"]=$t(t),Object.entries(It).forEach((([t,n])=>{e(t,n)})),xt.forEach((t=>{e(`„Çì${t}`,`n'${n(t)[""]}`)})),Object.freeze(JSON.parse(JSON.stringify(t)))}()),At}function $t(t){return Object.entries(t).reduce(((t,[n,e])=>{if(n)t[n]=$t(e);else{const r=e.charAt(0);t[n]=Object.keys(Rt).includes(r)?Rt[r]+e:e}return t}),{})}const Jt=$(((t,n)=>{let e=function(t){return t===g?Tt():{}}(t);return n&&(e=P(e,n)),e}),W);function Kt(t="",n={},e){const r=F(n);return e||(e=Jt(r.romanization,r.customRomajiMapping)),function(t,n,e){e||(e=Jt(n.romanization,n.customRomajiMapping));const r=Object.assign({},{isDestinationRomaji:!0},n);return B(St(t,Kt,r),e,!n.IMEMode)}(t,r,e).map((n=>{const[e,o,i]=n;return r.upcaseKatakana&&mt(t.slice(e,o))?i.toUpperCase():i})).join("")}function Wt(t=""){return!p(t)&&q.some((([n,e])=>d(t,n,e)))}function Ft(t="",n={}){const e=F(n);if(e.passRomaji)return St(t,Kt,e);if(vt(t,{passKanji:!0})){return pt(St(t,Kt,e).toLowerCase(),e)}return ht(t)||Wt(t)?pt(t.toLowerCase(),e):St(t,Kt,e)}var Bt={};Bt=function(){function t(t,n,e,r,o){return t<n||e<n?t>e?e+1:t+1:r===o?n:n+1}return function(n,e){if(n===e)return 0;if(n.length>e.length){var r=n;n=e,e=r}for(var o=n.length,i=e.length;o>0&&n.charCodeAt(o-1)===e.charCodeAt(i-1);)o--,i--;for(var c=0;c<o&&n.charCodeAt(c)===e.charCodeAt(c);)c++;if(i-=c,0===(o-=c)||i<3)return i;var a,s,u,f,l,p,d,h,g,y,m,b,w=0,v=[];for(a=0;a<o;a++)v.push(a+1),v.push(n.charCodeAt(c+a));for(var j=v.length-1;w<i-3;)for(g=e.charCodeAt(c+(s=w)),y=e.charCodeAt(c+(u=w+1)),m=e.charCodeAt(c+(f=w+2)),b=e.charCodeAt(c+(l=w+3)),p=w+=4,a=0;a<j;a+=2)s=t(d=v[a],s,u,g,h=v[a+1]),u=t(s,u,f,y,h),f=t(u,f,l,m,h),p=t(f,l,p,b,h),v[a]=p,l=f,f=u,u=s,s=d;for(;w<i;)for(g=e.charCodeAt(c+(s=w)),p=++w,a=0;a<j;a+=2)d=v[a],v[a]=p=t(d,s,p,g,v[a+1]),s=d;return p}}();const Dt={b:"„Å≥",ezone:"„ÅÑ„Åû„Çì",gt:"„Åò„Åç",g:"„Åò",ec2:"„ÅÑ„Åó„Å§","ec 2":"„ÅÑ„Åó„Å§",ec:"„ÅÑ„Åó",agar:"„ÅÇ„Åå„Çã",ol:"„Åä„Åà„Çã",ob:"„Åä„Å≥",k:"„Åë„ÅÑ",c:"„Åó",cd:"„Åó„Çä",ck:"„Åó„Åë„ÅÑ",y:"„Çè„ÅÑ",uber:"„ÅÜ„Å∞",hulu:"„Åµ„Çã",canyou:"„Åã„Çì„ÇÜ„ÅÜ",LINE:"„Çâ„ÅÑ",2:"„Å§",3:"„Åï„Çì",5:"„Åî",9:"„Åç„ÇÖ„ÅÜ",10:"„Åò„ÇÖ",x:"„Åò„ÇÖ",1e3:"„Åõ„Çì","„ÉØ„Éº„Åè":"„Çè„Åè","Ë•øÂõΩ":"„Åï„ÅÑ„Åì„Åè","Â∏∞„Å£„Å¶":"„Åã„Åà„Å£„Å¶","„ÇíÂëº„Å∂":"„Åä„Çà„Å∂","ÊéåËπ†":"„Åó„Çá„ÅÜ„Åõ„Åç","‰ª∂Âêç":"„Åë„Çì„ÇÅ„ÅÑ","Âä†Ëó§":"„Åã„Å®„ÅÜ","Ë≤®Áâ©Á∑ö":"„Åã„ÇÇ„Å§„Åõ„Çì","Áü≠Ë∂≥":"„Åü„Çì„Åù„Åè","5Âõû":"„Åî„Åã„ÅÑ","„Åë„Åà„Åç":"„Åë„ÅÑ„Åç","Ë¶ó„ÅÑ„Å¶":"„ÅÆ„Åû„ÅÑ„Å¶","ÂªÉÁóÖ":"„ÅØ„ÅÑ„Å≥„Çá„ÅÜ","Ê≠£Ë¶≥":"„Åõ„ÅÑ„Åã„Çì","ÂÄü„Çä„Å´":"„Åã„Çä„Å´","ÂÖ®Èñã":"„Åú„Çì„Åã„ÅÑ","‰πùÂ§ß":"„Åç„ÇÖ„ÅÜ„Å†„ÅÑ","ÊúÄÈÄü":"„Åï„ÅÑ„Åù„Åè","ÈæçÈ®é":"„Çä„ÇÖ„ÅÜ„Åç","ÊµÅÊòü":"„Çä„ÇÖ„ÅÜ„Åõ„ÅÑ","‰∫¨‰∏π":"„Åç„Çá„ÅÜ„Åü„Çì","Â∫ÉÈôµ":"„Åì„ÅÜ„Çä„Çá„ÅÜ","Êãõ„Åã„Çå„Çã":"„Åæ„Å≠„Åã„Çå„Çã","ÁúåÂ¢É":"„Åë„Çì„Åç„Çá„ÅÜ","ËÉÜÊ±Å":"„Åü„Çì„Åò„ÇÖ„ÅÜ","ÁúåÂêç":"„Åë„Çì„ÇÅ„ÅÑ","Èï∑Ê±ü":"„Å°„Çá„ÅÜ„Åì„ÅÜ"};function Vt(t,n){if(!I(t.data))return null;return Pt(t.data)===Pt(n)?n:null}function Ut(t,n){const e=t.data;for(const t of n)if(t===e||t===Dt[e.toLowerCase()])return t;return null}function Pt(t){return t.toLowerCase().replaceAll(" ","")}function Gt(n,e){const r=n.data;for(const n of e){if(Pt(n)===Pt(r))return n;if(t(Bt)(Pt(n),Pt(r))<2)return n}return null}function Ht(t,n){return{success:!0,message:"correct answer",candidate:t,answer:n}}function Qt(t,n,e){const{meanings:r,readings:o,prompt:i}=t;let c=[];c.push({type:"raw",data:e});const a=(s="order",n.reduce((function(t,n){return(t[n[s]]=t[n[s]]||[]).push(n),t}),{}));var s;const u=Object.keys(a).map((t=>parseInt(t))).sort();for(const t of u){const n=a[t],e=[];for(const t of n)for(const n of c)e.push(...t.getCandidates(n.data));c.push(...e)}let f={error:!1,message:"incorrect answer"};for(const t of c){const n=Gt(t,r),e=Ut(t,o),c=Vt(t,i);e?f=Ht(t,e):c&&o.length>0?f=Ht(t,o[0]):n&&(f=Ht(t,n))}return f.candidates=c,f.meanings=r,f.readings=o,f}const Xt="#ffd700",Yt="#000000";function Zt(){return tn().lightning}function tn(){return unsafeWindow.wkof?unsafeWindow.wkof.settings["wanikani-voice-input"]:{lightning:!1,transcript:!0,transcript_background:Xt,transcript_foreground:Yt,transcript_position:"top",transcript_delay:5e3}}function nn(t,n){if(!("webkitSpeechRecognition"in window))return console.error("[wanikani-voice-input] web speech not supported by this browser!"),null;const e=new webkitSpeechRecognition;return e.continuous=!0,e.interimResults=!0,e.lang=t,e.onresult=t=>{for(let e=t.resultIndex;e<t.results.length;++e){const r=t.results[e][0].transcript.trim(),o=t.results[e].isFinal;n(r,o)}},e.onerror=t=>{"no-speech"!==t.error&&console.error("[wanikani-voice-input] error occurred in recognition:",t.error)},e.onend=()=>{e.start()},e}function en(t,n){t.lang!=n&&(t.stop(),t.lang=n)}function rn(t){let n=t.transcript_position,e="width: 100%; position: absolute; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: none;";return"top"===n||"bottom"===n?e+=` ${n}: 0px`:"center"===n&&(e+=" top: 45vh"),e}function on(t){const n=document.createElement("div");n.id="wanikani-voice-input-transcript-container",n.style=rn(t),document.body.appendChild(n)}let cn=1;function an(t){const n=document.getElementById(t);if(n){n.parentElement.removeChild(n)}}function sn(t,n){if(!t.transcript)return;const e="üé§"+n,r=document.getElementById("transcript-"+(cn-1));if(r&&e===r.textContent)return;const o=cn++,i=`transcript-${o}`,c=document.createElement("p");c.id=i,c.style=function(t){return`color: ${t.transcript_foreground}; background-color: ${t.transcript_background}; font-size: 5vh; pointer-events: auto;`}(t),c.textContent=e;const a=document.querySelector("div#wanikani-voice-input-transcript-container");a.style=rn(t),a.appendChild(c),setTimeout(function(t){return function(){an(t)}}(i),1e3*t.transcript_delay);const s=o-10;for(let n=o-t.transcript_count;n>=s&&n>=0;n--)an(`transcript-${n}`)}function un(t,n,e){t[n]||(t[n]=e),t[n].push(e)}function fn(){let t=JSON.parse(GM_getResourceText("jmdict")),n=JSON.parse(GM_getResourceText("kanjidic2")),e={};for(const[n,r]of Object.entries(t))un(e,n,r);for(const[t,r]of Object.entries(n))un(e,t,r);const r=Object.keys(e).length;return console.log(`[wanikani-voice-input] got dictionary with ${r} entries`),e}class ln{constructor(t){this.order=0}getCandidates(t){const n=[];if(I(t)){const e=Ft(t,{convertLongVowelMark:!0});n.push({type:"hiragana",data:e})}return n}}class pn{constructor(t){this.order=0,this.dictionary=t}getCandidates(t){if(!I(t))return[];const n=[],e=Ft(t);const r=function(t){return t.flatMap((t=>"word"===t.type?t.kana.map(Ft):"character"===t.type?t.readings.map((t=>{let n=t.value;return n.includes(".")&&(n=n.split(".")[0]),Ft(n)})):[]))}(this.dictionary[e]||[]);for(let t of r)n.push({type:"dictionary",data:t});return n}}class dn{constructor(t){this.order=0,this.basicDictionary=new pn(t)}getCandidates(t){const n=Ft(t),e=[];if(n.endsWith("„Åô„Çã")){const t=n.substring(0,n.length-2),r=this.basicDictionary.getCandidates(t);for(let t of r)e.push({type:"„Åô„Çã",data:t+"„Åô„Çã"})}return e}}class hn{constructor(){this.order=1}getCandidates(t){const n=[],e=function(t){let n=t.length;for(let e=Math.floor(n/2);e>0;e--)if(n%e==0){let r=!0,o=t.slice(0,e);for(let i=e;i<n;i+=e)if(t.slice(i,i+e)!==o){r=!1;break}if(r)return o}return null}(t);return e&&n.push({type:"repeating",data:e}),n}}!function(){const t=["„ÅÇ","„ÅÑ","„ÅÜ","„Åà","„ÅÑ","„Åä","„ÅÜ","„Åã","„Åç","„Åè","„Åë","„Åë","„Åì","„Åì","„Åå","„Åé","„Åê","„Åí","„Åí","„Åî","„Åî","„Åï","„Åó","„Åô","„Åõ","„Åõ","„Åù","„Åù","„Åñ","„Åò","„Åö","„Åú","„Åú","„Åû","„Åû","„Åü","„Å°","„Å§","„Å¶","„Å¶","„Å®","„Å®","„Å†","„Å¢","„Å•","„Åß","„Åß","„Å©","„Å©","„Å™","„Å´","„Å¨","„Å≠","„Å≠","„ÅÆ","„ÅÆ","„ÅØ","„Å≤","„Åµ","„Å∏","„Å∏","„Åª","„Åª","„Å∞","„Å≥","„Å∂","„Åπ","„Åπ","„Åº","„Åº","„Å±","„Å¥","„Å∑","„Å∫","„Å∫","„ÅΩ","„ÅΩ","„Åæ","„Åø","„ÇÄ","„ÇÅ","„ÇÅ","„ÇÇ","„ÇÇ","„ÇÑ","yi","„ÇÜ","ye","ye","„Çà","„Çà","„Çâ","„Çä","„Çã","„Çå","„Çå","„Çç","„Çç","„Çè","„Çê","wu","„Çë","„Çë","„Çí","„Çí"],n=[];for(let e=0;e<t.length;e+=7){const r=t.slice(e,e+7);n.push(r)}const e={};for(let t=0;t<n.length;t++){const r=n[t];for(let t=0;t<7;t++)(e[r[t]]=e[r[t]]||[]).push(n[0][t])}e["„ÇÉ"]=["„ÅÇ"],e["„ÇÖ"]=["„ÅÜ"],e["„Çá"]=["„Åä","„ÅÜ"]}();class gn{constructor(t){this.order=0,this.dictionary=t}getCandidates(t){if(!t||0===t.length)return[];if(!I(t.split("").filter((t=>" "!==t)).join("")))return[];const n=[];if(t.includes(" ")){const e=t.split(" ").filter((t=>t.length>0)).map((t=>{const n=Ft(t);const e=function(t){return t.flatMap((t=>"word"===t.type?t.kana.map(Ft):"character"===t.type?t.readings.map((t=>{let n=t.value;return n.includes(".")&&(n=n.split(".")[0]),Ft(n)})):[]))}(this.dictionary[n]||[]);return e.length>0?e[0]:""}));n.push({type:"multiple",data:e.join("")})}return n}}function yn(){!function(){for(const t of Object.keys(n))document.querySelector(n[t])||console.error(`[wanikani-voice-input] failed to find ${t}: ${n[t]}`)}(),on(tn());!function(t){let n="Flipping",e=o();function i(t){n=t}function u(){c(),i("Flipping")}const l={wrong:a,incorrect:a,mistake:a,"‰∏çÊ≠£Ëß£":a,"„Åµ„Åõ„ÅÑ„Åã„ÅÑ":a,"ÈñìÈÅï„ÅÑ":a,"„Åæ„Å°„Åå„ÅÑ":a,"„Å†„ÇÅ":a,"„ÉÄ„É°":a,next:u,"„Å§„Åé":u,"Ê¨°":u,NEXT:u,"„Å≠„Åè„Åô„Å®":u,"„Éç„ÇØ„Çπ„Éà":u},p=[new ln,new pn(t),new dn(t),new hn,new gn(t)],d=nn(r(),(function(t,e){sn(tn(),t);let r=function(t,n,e,r,i){let c=n,a=null,s=null,u=!1,f=r;if("Ready"===n){const n=Qt(o(),t,r);console.log("[wanikani-voice-input]",r,n),n.candidate&&f!==n.candidate.data&&(f+=` (${n.candidate.data})`),n.success?i?(c="Flipping",a=n.answer):(c="Waiting",a=n.answer):n.error&&(f="!! "+n.message+" !!")}"Waiting"===n&&i&&(c="Flipping",u=Zt());("Ready"===n||"Flipping"===n)&&i&&e[r]&&(s=e[r]);return{newState:c,transcript:f,answer:a,command:s,lightning:u}}(p,n,l,t,e);sn(tn(),r.transcript),n!==r.newState&&i(r.newState),r.answer&&s(r.answer),r.lightning&&setTimeout(c,100),r.command&&r.command()}));function h(t,c){const a=r();en(d,a);const s=function(t){const n=o();return t.prompt!==n.prompt||t.category!==n.category||t.type!==n.type?n:null}(e);"Flipping"===n&&s&&(i("Ready"),e=s)}const g={attributes:!0,childList:!0,subtree:!0};new MutationObserver(h).observe(document.body,g),window.addEventListener("didAnswerQuestion",(function(t){!function(t){if("object"!=typeof t.detail||"object"!=typeof t.detail.results)return console.error("[wanikani-voice-input] didAnswerCorrectly got unexpected event, WaniKani code change?",t),!1;const n=t.detail.results;return t.detail,"string"!=typeof n.action?(console.error("[wanikani-voice-input] didAnswerCorrectly got unexpected event, WaniKani code change?",t),!1):"pass"===n.action}(t)?Zt()&&setTimeout(f,100):"Ready"===n&&(n="Flipping",Zt()&&setTimeout(c,100))})),d.start(),n="Ready"}(fn())}if(unsafeWindow.wkof){!function(t,n){function e(){var n={script_id:"wanikani-voice-input",title:"Voice Input",content:{lightning:{type:"checkbox",label:"Lightning mode",default:!1,hover_tip:"If enabled, automatically advance to the next flashcard on correct answers. If enabled, please disable lightning mode from any other scripts."},transcript:{type:"checkbox",label:"Live transcript",default:!0,hover_tip:"If enabled, displays a live transcript of dictation"},transcript_background:{type:"color",label:"Transcript background color",hover_tip:"Background color for the live transcript",default:Xt},transcript_foreground:{type:"color",label:"Transcript text color",hover_tip:"Text color for the live transcript",default:Yt},transcript_position:{type:"dropdown",label:"Transcript position",hover_tip:"Position on the page for the live transcript",default:"top",content:{top:"Top",bottom:"Bottom"}},transcript_delay:{type:"number",label:"Transcript delay",hover_tip:"Duration in seconds before live transcripts disappear",min:0,default:5},transcript_count:{type:"number",label:"Transcript count",hover_tip:"How many live transcripts to show (recommend setting position to bottom if this is more then 1)",min:1,default:1}}};new t.Settings(n).open()}t.include("Menu,Settings"),t.ready("Menu,Settings").then((function(){t.Menu.insert_script_link({name:"wanikani-voice-input",submenu:"Settings",title:"Voice Input",on_click:e})})).then((function(){return t.Settings.load("wanikani-voice-input")})).then(n)}(unsafeWindow.wkof,yn)}else console.log("[wanikani-voice-input] wkof not found?"),yn()})();
//# sourceMappingURL=app.js.map
